# SonarQube Configuration for PR Testing
# エス・エー・エス株式会社 - 静的コード分析設定

# =====================================
# プロジェクト基本設定
# =====================================
sonar.projectKey=sas-github-guidelines
sonar.projectName=SAS GitHub Guidelines
sonar.projectVersion=1.0.0
sonar.organization=sas-com

# プロジェクト説明
sonar.projectDescription=エス・エー・エス株式会社のGitHubガイドライン - PR自動テスト基盤

# =====================================
# ソースコード設定
# =====================================
# ソースコードディレクトリ
sonar.sources=src,scripts
sonar.tests=tests,src/**/*.test.*,src/**/*.spec.*

# ファイル除外設定
sonar.exclusions=**/node_modules/**,**/dist/**,**/build/**,**/coverage/**,**/*.min.js,**/vendor/**,**/public/**

# テストファイル除外設定
sonar.test.exclusions=**/node_modules/**,**/dist/**,**/build/**

# =====================================
# 言語別設定
# =====================================

# JavaScript/TypeScript設定
sonar.javascript.lcov.reportPaths=coverage/lcov.info
sonar.typescript.lcov.reportPaths=coverage/lcov.info
sonar.javascript.file.suffixes=.js,.jsx
sonar.typescript.file.suffixes=.ts,.tsx

# Python設定
sonar.python.coverage.reportPaths=coverage/coverage.xml
sonar.python.xunit.reportPath=test-results/pytest-results.xml

# Java設定（必要に応じて）
sonar.java.source=11
sonar.java.target=11
sonar.java.binaries=target/classes
sonar.junit.reportPaths=target/surefire-reports

# =====================================
# 品質プロファイル設定
# =====================================

# 品質ゲート
sonar.qualitygate.wait=true

# カバレッジ設定
sonar.coverage.exclusions=**/*.test.*,**/*.spec.*,**/tests/**,**/mock/**,**/*.config.*,**/*.stories.*

# 重複コード検出
sonar.cpd.exclusions=**/*.test.*,**/*.spec.*

# =====================================
# セキュリティ設定
# =====================================

# セキュリティホットスポット検出
sonar.security.hotspots.inheritance.enabled=true

# 脆弱性検出設定
sonar.security.review.enabled=true

# OWASP Top 10対応
sonar.security.owasp.enabled=true

# CWE (Common Weakness Enumeration) 対応
sonar.security.cwe.enabled=true

# SANS Top 25対応
sonar.security.sans.enabled=true

# =====================================
# パフォーマンス・保守性設定
# =====================================

# 技術的負債の比率（分単位）
sonar.technicalDebt.ratingGrid=0.05,0.1,0.2,0.5

# 複雑度設定
sonar.complexity.threshold=15

# メソッド・クラスの行数制限
sonar.size.methods=50
sonar.size.classes=500

# =====================================
# PR分析設定
# =====================================

# GitHub統合設定（環境変数で設定される）
# sonar.pullrequest.key=${GITHUB_PR_NUMBER}
# sonar.pullrequest.branch=${GITHUB_HEAD_REF}
# sonar.pullrequest.base=${GITHUB_BASE_REF}
# sonar.pullrequest.github.repository=${GITHUB_REPOSITORY}

# PR分析の焦点
sonar.pullrequest.vsts.instanceUrl=${SONAR_HOST_URL}
sonar.pullrequest.github.endpoint=https://api.github.com

# =====================================
# レポート設定
# =====================================

# XMLレポート出力
sonar.issuesReport.console.enable=true
sonar.issuesReport.html.enable=true

# カスタムメトリクス
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5
sonar.issue.ignore.multicriteria.e1.ruleKey=javascript:S3776
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.test.js

# テストファイルでの複雑度チェックを緩和
sonar.issue.ignore.multicriteria.e2.ruleKey=typescript:S3776
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.test.ts

# モックファイルでの未使用変数を許可
sonar.issue.ignore.multicriteria.e3.ruleKey=typescript:S1481
sonar.issue.ignore.multicriteria.e3.resourceKey=**/mocks/**

# 設定ファイルでのconsole.log許可
sonar.issue.ignore.multicriteria.e4.ruleKey=javascript:S2228
sonar.issue.ignore.multicriteria.e4.resourceKey=**/*.config.js

# Storybookファイルでの制約緩和
sonar.issue.ignore.multicriteria.e5.ruleKey=typescript:S3776
sonar.issue.ignore.multicriteria.e5.resourceKey=**/*.stories.*

# =====================================
# 品質ゲート条件
# =====================================

# 新コードの品質条件
sonar.newCode.referenceBranch=main

# 品質ゲートの条件設定（参考値）
# - Coverage on New Code >= 80%
# - Duplicated Lines on New Code <= 3%
# - Maintainability Rating on New Code = A
# - Reliability Rating on New Code = A
# - Security Rating on New Code = A
# - Security Hotspots Reviewed on New Code >= 100%

# =====================================
# CI/CD統合設定
# =====================================

# GitHub Actions統合
sonar.scanner.metadataFilePath=.scannerwork/report-task.txt

# 外部イシュー統合
sonar.externalIssuesReportPaths=external-issues-report.json

# =====================================
# カスタムルール設定
# =====================================

# SAS固有のルール設定
sonar.typescript.tsconfigPath=tsconfig.json
sonar.eslint.reportPaths=eslint-report.json

# ログレベル
sonar.log.level=INFO
sonar.verbose=false

# =====================================
# 高度な設定
# =====================================

# 並列実行設定
sonar.ce.gracefulStopTimeOutInMs=60000

# メモリ設定
sonar.scanner.javaOpts=-Xmx1024m

# タイムアウト設定
sonar.scanner.responseTimeout=60

# WebAPIタイムアウト
sonar.ws.timeout=60

# =====================================
# 環境別設定
# =====================================

# 開発環境での設定
# sonar.branch.name=develop
# sonar.branch.target=main

# 本番環境での設定
# sonar.branch.name=main

# プロファイル設定
sonar.profile.js=SAS JavaScript Security Profile
sonar.profile.ts=SAS TypeScript Security Profile
sonar.profile.py=SAS Python Security Profile