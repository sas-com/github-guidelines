# GitHub Actions設定チェックリスト

**エス・エー・エス株式会社**  
*GitHub Actions運用のための包括的チェックリスト*

## 目次

1. [概要](#概要)
2. [基本設定チェック](#基本設定チェック)
3. [ワークフロー品質チェック](#ワークフロー品質チェック)
4. [環境別デプロイチェック](#環境別デプロイチェック)
5. [監視・ログ・通知チェック](#監視ログ通知チェック)
6. [コンプライアンス・ガバナンス](#コンプライアンスガバナンス)
7. [災害復旧・事業継続性](#災害復旧事業継続性)
8. [運用チェック](#運用チェック)

---

## 概要

本チェックリストは、エス・エー・エス株式会社のGitHub Actions運用において、セキュリティ、パフォーマンス、ガバナンスを確保するための包括的なガイドラインです。

### 適用環境
- **現在**: dev環境のみ運用中
- **将来**: main/staging/dev の3環境構成
- **セキュリティ**: 2FA必須、Private必須、強制プッシュ禁止

---

## 基本設定チェック

### リポジトリ設定

#### Actions権限設定
- [ ] **Actions権限を適切に設定済み**
  - [ ] Actions有効化（Settings > Actions > General）
  - [ ] 適切なActions実行権限レベル設定
  - [ ] 不要なActions無効化
- [ ] **ワークフロー権限の適切性確認**
  - [ ] GITHUB_TOKEN権限を最小限に設定
  - [ ] Read/Write権限の明示的指定
  - [ ] contents、issues、pull-requests権限の適切性確認
- [ ] **Third-party actions使用許可範囲の確認**
  - [ ] 許可されたMarketplace actionsのリスト管理
  - [ ] 社内承認済みactions以外の使用制限
  - [ ] アクション使用時のバージョン固定（@v1.2.3形式）

#### セキュリティ設定
- [ ] **Secrets管理の適切性確認**
  - [ ] 環境別Secretsの分離設定
  - [ ] 不要なSecretsの削除
  - [ ] Secretsアクセス権限の最小化
  - [ ] 定期的なSecrets見直し・更新
- [ ] **環境変数の暗号化確認**
  - [ ] 機密情報の平文での記載なし
  - [ ] 環境変数スコープの適切性
  - [ ] ログ出力時の機密情報マスキング
- [ ] **Pull request実行権限制御**
  - [ ] 外部contributorからのPR実行制限
  - [ ] フォークからのSecrets使用制限
  - [ ] PRワークフロー承認プロセス設定

### ブランチ保護設定

#### 保護ルール設定
- [ ] **必須チェック項目の設定**
  - [ ] ステータスチェック必須化（CI/CD、テスト、セキュリティスキャン）
  - [ ] 最新ブランチ必須化
  - [ ] Linear historyの強制（必要に応じて）
- [ ] **マージ前必須レビュー設定**
  - [ ] 必須レビュー数の設定（最低1名）
  - [ ] Code ownersによるレビュー必須化
  - [ ] 変更時のレビュー再要求設定
- [ ] **管理者権限の制御**
  - [ ] Administrator例外設定の最小化
  - [ ] 緊急時対応手順の明確化
  - [ ] 管理者アクションの監査ログ確認

---

## ワークフロー品質チェック

### YAML構文・構造

#### 基本構文
- [ ] **YAML文法の正確性確認**
  - [ ] インデント統一（2スペース推奨）
  - [ ] 構文エラーの事前チェック
  - [ ] 予約語の適切な使用
- [ ] **Job間依存関係設定**
  - [ ] needs設定の適切性
  - [ ] 循環依存の排除
  - [ ] 失敗時の処理継続設定（continue-on-error）
- [ ] **条件分岐の適切性**
  - [ ] if条件の明確性
  - [ ] ブランチ・イベント条件の適切性
  - [ ] 環境変数による条件分岐
- [ ] **タイムアウト設定**
  - [ ] Job・Stepレベルでのタイムアウト設定
  - [ ] 適切なタイムアウト時間設定
  - [ ] 長時間実行処理の最適化

#### パフォーマンス最適化
- [ ] **不要なJob実行の回避**
  - [ ] path-ignore設定によるスキップ
  - [ ] ブランチ固有の実行制御
  - [ ] 変更検知による最適化
- [ ] **キャッシュ戦略の実装**
  - [ ] 依存関係キャッシュ（npm、pip、maven等）
  - [ ] ビルド成果物キャッシュ
  - [ ] キャッシュキー戦略の最適化
  - [ ] キャッシュサイズ・期限管理
- [ ] **並列実行の最適化**
  - [ ] matrix strategyの適切な使用
  - [ ] 独立したJobの並列実行
  - [ ] リソース競合の回避

### セキュリティベストプラクティス

#### Secrets・認証情報管理
- [ ] **Secretsの安全な使用**
  - [ ] ハードコードされた認証情報の排除
  - [ ] 環境別Secrets使用の適切性
  - [ ] Secretsの最小スコープ適用
- [ ] **環境変数の適切なスコープ**
  - [ ] Job・Stepレベルでの変数スコープ制限
  - [ ] 機密情報の適切な変数スコープ
  - [ ] デフォルト値の安全性確認
- [ ] **第三者Actionのセキュリティ**
  - [ ] Actionバージョンの固定（@v1.2.3形式）
  - [ ] 信頼できるpublisher使用の確認
  - [ ] Action使用前のセキュリティ検証
  - [ ] 社内承認プロセスの確認

#### アクセス制御
- [ ] **最小権限の原則適用**
  - [ ] GITHUB_TOKEN権限の最小化
  - [ ] Job間でのSecrets共有制限
  - [ ] 外部リソースアクセス制限
- [ ] **実行環境の分離**
  - [ ] 環境別runner使用
  - [ ] ネットワークアクセス制限
  - [ ] ファイルシステム分離

---

## 環境別デプロイチェック

### 環境管理

#### 環境設定分離
- [ ] **環境固有設定の分離**
  - [ ] 環境別設定ファイル管理
  - [ ] 設定値の環境変数化
  - [ ] デフォルト値の適切性確認
- [ ] **環境別Secretsの管理**
  - [ ] 環境毎のSecrets分離
  - [ ] アクセス権限の環境別制御
  - [ ] 本番環境Secretsの厳重管理
- [ ] **デプロイ承認フローの設定**
  - [ ] 環境別承認者設定
  - [ ] 手動承認ゲート設定
  - [ ] 承認プロセスの明文化

#### デプロイ戦略
- [ ] **段階的デプロイの実装**
  - [ ] dev → staging → mainの順次デプロイ
  - [ ] 各環境でのテスト実行
  - [ ] 失敗時の自動停止
- [ ] **ロールバック手順の確認**
  - [ ] 自動ロールバック条件設定
  - [ ] 手動ロールバック手順明確化
  - [ ] ロールバック後の検証手順

### 本番デプロイ特別チェック

#### 本番環境保護
- [ ] **本番環境保護設定**
  - [ ] Environment protection rules設定
  - [ ] 必須レビュアー設定
  - [ ] Wait timer設定（クールダウン期間）
- [ ] **手動承認ゲートの設定**
  - [ ] 本番デプロイ前の手動確認
  - [ ] 承認者権限の適切性
  - [ ] 承認プロセスの文書化
- [ ] **デプロイ時間帯制限**
  - [ ] 営業時間外デプロイ制限
  - [ ] メンテナンス窓口の遵守
  - [ ] 緊急時例外手順の明確化

#### 緊急時デプロイ
- [ ] **緊急時デプロイ手順**
  - [ ] ホットフィックス専用ワークフロー
  - [ ] 緊急時承認プロセス短縮
  - [ ] 事後承認・レビュープロセス
- [ ] **リスク軽減策**
  - [ ] 最小限変更の原則
  - [ ] 即座のロールバック準備
  - [ ] 影響範囲の事前評価

---

## 監視・ログ・通知チェック

### モニタリング

#### ワークフロー監視
- [ ] **実行状況の監視**
  - [ ] 成功率・失敗率の追跡
  - [ ] 実行時間の監視
  - [ ] 実行頻度の分析
- [ ] **パフォーマンス監視**
  - [ ] リソース使用量監視
  - [ ] 実行時間の傾向分析
  - [ ] ボトルネック特定
- [ ] **コスト監視**
  - [ ] Actions実行分数の追跡
  - [ ] 環境別コスト分析
  - [ ] 最適化機会の特定

#### アラート設定
- [ ] **失敗アラート**
  - [ ] 即座の失敗通知
  - [ ] 連続失敗時のエスカレーション
  - [ ] 重要度別アラート分類
- [ ] **しきい値アラート**
  - [ ] 実行時間超過アラート
  - [ ] 成功率低下アラート
  - [ ] コスト超過アラート

### ログ管理

#### ログ設定
- [ ] **適切なログレベル設定**
  - [ ] 環境別ログレベル設定
  - [ ] デバッグ情報の適切な出力
  - [ ] 本番環境でのログレベル最適化
- [ ] **機密情報のログ出力防止**
  - [ ] Secrets自動マスキング確認
  - [ ] 個人情報ログ出力回避
  - [ ] API KEY等の暗号化
- [ ] **トラブルシューティング情報**
  - [ ] エラー詳細の適切な出力
  - [ ] 実行環境情報の記録
  - [ ] 再現手順情報の記録

#### ログ保持・管理
- [ ] **ログの保持期間設定**
  - [ ] 法的要件に基づく保持期間
  - [ ] 監査要件の考慮
  - [ ] ストレージコスト最適化
- [ ] **ログアクセス制御**
  - [ ] ログ閲覧権限の制限
  - [ ] 監査ログの完全性保護
  - [ ] ログ改ざん防止措置

### 通知設定

#### 基本通知
- [ ] **成功・失敗時の通知設定**
  - [ ] 適切な通知チャネル設定
  - [ ] 通知内容の最適化
  - [ ] 通知頻度の調整
- [ ] **チーム別通知設定**
  - [ ] プロジェクト別通知分離
  - [ ] 役割別通知内容調整
  - [ ] 通知受信者の定期見直し

#### 緊急時通知
- [ ] **緊急時エスカレーション通知**
  - [ ] L1-L4レベル別通知設定
  - [ ] エスカレーション手順の自動化
  - [ ] 緊急連絡先への確実な通知
- [ ] **通知内容の最適化**
  - [ ] 緊急度の明確な表示
  - [ ] 対応手順の通知への含有
  - [ ] 影響範囲の明確化

---

## コンプライアンス・ガバナンス

### 監査・トレーサビリティ

#### 実行履歴管理
- [ ] **実行履歴の保持**
  - [ ] 必要期間の実行ログ保持
  - [ ] 実行結果の詳細記録
  - [ ] 失敗原因の追跡可能性
- [ ] **変更履歴の追跡**
  - [ ] ワークフロー変更履歴の記録
  - [ ] 設定変更の承認記録
  - [ ] 変更者・変更理由の記録
- [ ] **承認プロセスの記録**
  - [ ] 承認者・承認時刻の記録
  - [ ] 承認理由の文書化
  - [ ] 承認プロセスの標準化

#### セキュリティ監査対応
- [ ] **セキュリティ監査対応**
  - [ ] アクセスログの完全性
  - [ ] セキュリティイベントの記録
  - [ ] 侵入検知・対応手順
- [ ] **定期的なセキュリティレビュー**
  - [ ] 四半期毎のアクセス権限見直し
  - [ ] Secrets定期更新
  - [ ] 脆弱性スキャン結果確認

### ポリシー準拠

#### 社内ポリシー準拠
- [ ] **セキュリティポリシー準拠**
  - [ ] 社内セキュリティ基準遵守
  - [ ] データ分類に基づくアクセス制御
  - [ ] インシデント対応手順遵守
- [ ] **変更管理プロセス準拠**
  - [ ] 変更承認プロセス遵守
  - [ ] 影響評価の実施
  - [ ] 変更後の検証手順

#### データ保護・プライバシー
- [ ] **データ保護規制対応**
  - [ ] 個人情報処理の適切性
  - [ ] データ保存場所の規制遵守
  - [ ] データ削除・匿名化手順
- [ ] **プライバシー保護**
  - [ ] 個人情報ログ出力回避
  - [ ] 第三者への情報漏洩防止
  - [ ] 同意に基づく情報処理

---

## 災害復旧・事業継続性

### バックアップ・復旧

#### 設定バックアップ
- [ ] **ワークフロー設定のバックアップ**
  - [ ] ワークフローファイルのバージョン管理
  - [ ] 設定変更履歴の保持
  - [ ] 自動バックアップの設定
- [ ] **Secretsの安全なバックアップ**
  - [ ] 暗号化されたSecrets保存
  - [ ] アクセス制御されたバックアップ
  - [ ] 定期的なバックアップ検証
- [ ] **災害時の復旧手順**
  - [ ] 復旧手順書の整備
  - [ ] 復旧テストの定期実施
  - [ ] RTO/RPO目標の設定

#### 代替環境準備
- [ ] **代替実行環境の準備**
  - [ ] セルフホストランナーの準備
  - [ ] 別リージョン環境の準備
  - [ ] 外部CI/CDサービスの準備

### 高可用性対応

#### 障害対応
- [ ] **複数リージョン対応**
  - [ ] 地理的分散された実行環境
  - [ ] リージョン間でのフェイルオーバー
  - [ ] データ同期の整合性確保
- [ ] **部分機能停止への対応**
  - [ ] 重要度別サービス分離
  - [ ] 段階的な機能停止・復旧
  - [ ] ユーザー影響の最小化

#### 継続性計画
- [ ] **事業継続計画（BCP）**
  - [ ] 重要業務の優先度設定
  - [ ] 最低限機能での運用継続
  - [ ] ステークホルダーへの影響通知

---

## 運用チェック

### 日常運用

#### 定期メンテナンス
- [ ] **定期的な見直し・更新**
  - [ ] 月次でのワークフロー見直し
  - [ ] 使用していないワークフローの削除
  - [ ] パフォーマンス最適化の実施
- [ ] **依存関係の更新**
  - [ ] Actionバージョンの定期更新
  - [ ] セキュリティパッチの適用
  - [ ] 非推奨機能の置換

#### パフォーマンス監視
- [ ] **継続的な最適化**
  - [ ] 実行時間の継続監視
  - [ ] リソース使用量の最適化
  - [ ] コスト効率の改善

### 教育・トレーニング

#### チーム教育
- [ ] **ベストプラクティスの共有**
  - [ ] 定期的な勉強会開催
  - [ ] 知識ベースの整備
  - [ ] 事例共有・分析
- [ ] **新メンバーへの教育**
  - [ ] オンボーディング資料の整備
  - [ ] 実践的なトレーニング実施
  - [ ] メンター制度の活用

### 継続的改善

#### フィードバックループ
- [ ] **利用者フィードバックの収集**
  - [ ] 定期的な満足度調査
  - [ ] 改善要望の収集・評価
  - [ ] フィードバックに基づく改善実施
- [ ] **KPI監視・改善**
  - [ ] デプロイ頻度の監視
  - [ ] リードタイムの短縮
  - [ ] 変更失敗率の削減
  - [ ] 復旧時間の短縮

---

## チェックリスト使用ガイド

### 使用頻度
- **新規ワークフロー作成時**: 全項目チェック必須
- **既存ワークフロー変更時**: 関連項目チェック必須
- **定期レビュー**: 月次で全項目チェック
- **監査前**: 全項目チェック必須

### 重要度分類
- **🔴 Critical**: セキュリティ・本番環境に直接影響
- **🟡 High**: パフォーマンス・運用効率に影響
- **🟢 Medium**: 品質・保守性に影響
- **⚪ Low**: 推奨事項・将来への備え

### 責任者
- **開発者**: ワークフロー実装・基本チェック
- **DevOpsエンジニア**: 高度な設定・セキュリティチェック
- **セキュリティチーム**: セキュリティ関連項目監査
- **管理者**: ガバナンス・コンプライアンス確認

---

**更新履歴**
- 2025-09-10: 初版作成

**関連ドキュメント**
- [GitHub Actions運用手順書](./GITHUB_ACTIONS_OPERATIONS.md)
- [ワークフロー検証ツール](./scripts/workflow-validator.py)
- [自動チェックスクリプト](./scripts/actions-checker.sh)
- [テンプレート集](./templates/workflows/)

---

*このチェックリストは、エス・エー・エス株式会社のGitHub Actions運用品質向上のための実践的なガイドラインです。定期的な見直しと改善を実施してください。*